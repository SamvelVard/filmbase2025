{% extends 'news/base.html' %}
{% load static %}

{% block title %}–ö–∏–Ω–æ–Ω–æ–≤–æ—Å—Ç–∏{% endblock %}

{% block content %}
<div class="news-container">
    <!-- –ó–ê–ì–û–õ–û–í–û–ö -->
    <div class="news-header">
        <h1>
            üé¨ –ö–ò–ù–û–ù–û–í–û–°–¢–ò
{#            {% if user.is_superuser %}#}
{#              <a href="{% url 'news:news_create' %}" title="–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å" class="btn btn-primary"><i class="bi-plus-lg"></i></a>#}
{#            {% endif %}#}
        </h1>
        <p class="news-subtitle">–°–∞–º—ã–µ —Å–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –º–∏—Ä–∞ –∫–∏–Ω–æ –∏ —Å–µ—Ä–∏–∞–ª–æ–≤</p>
    </div>

    <!-- –ü–û–ò–°–ö –ò –§–ò–õ–¨–¢–†–´ -->
    <div class="news-controls">
        <div class="search-section">
            <form method="get" class="search-form">
                <input type="text" name="query" 
                       placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–≤–æ—Å—Ç—è–º..." 
                       value="{{ query|default:'' }}">
                <button type="submit">
                    –ù–∞–π—Ç–∏
                </button>
            </form>
        </div>
    </div>

    <!-- –°–ü–ò–°–û–ö –ù–û–í–û–°–¢–ï–ô -->
    <div class="news-grid">
        {% for item in news %}
        <div class="news-card">
            <!-- –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï -->
            {% if item.image %}
            <div class="news-image">
                <img src="{{ item.image.url }}" alt="{{ item.title }}">
                <!-- –ë–≠–î–ñ –î–õ–Ø –°–í–ï–ñ–ò–• –ù–û–í–û–°–¢–ï–ô -->
                {% comment %}
                <div class="news-badge">
                    –ù–û–í–û–ï
                </div>
                {% endcomment %}
            </div>
            {% endif %}

            <!-- –ö–û–ù–¢–ï–ù–¢ -->
            <div class="news-content">
                <h2 class="news-title">
                    <a href="{% url 'news:news_detail' item.id %}">
                        {{ item.title }}
                    </a>
                </h2>
                
                <!-- –ú–ï–¢–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø -->
                <div class="news-meta">
                    <span class="meta-date">
                        {{ item.published_at|date:"d.m.Y" }}
                    </span>
{#                    <span class="meta-comments">#}
{#                        üí¨ {{ item.comments_count }}#}
{#                    </span>#}
{#                    <span class="meta-likes">#}
{#                        ‚ù§Ô∏è {{ news.likes_count }}#}
{#                    </span>#}
                </div>

                <!-- –¢–ï–ì–ò -->
                {% if item.tags.all %}
                <div class="news-tags">
                    {% for tag in item.tags.all|slice:":3" %}
                    <span class="tag">#{{ tag.name }}</span>
                    {% endfor %}
                </div>
                {% endif %}

{#                <!-- –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò –ö–ù–û–ü–ö–ò -->#}
{#                <div class="news-footer">#}
{#                    <div class="reactions">#}
{#                        <span class="like-count">#}
{#                            üëç {{ news.likes_count }}#}
{#                        </span>#}
{#                        <span class="dislike-count">#}
{#                            üëé {{ news.dislikes_count }}#}
{#                        </span>#}
{#                    </div>#}
{#                </div>#}
            </div>
        </div>
        {% empty %}
        <!-- –ï–°–õ–ò –ù–û–í–û–°–¢–ï–ô –ù–ï–¢ -->
        <div class="no-news">
            <div class="no-news-icon">
                üé•
            </div>
            <h3>–ù–æ–≤–æ—Å—Ç–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</h3>
            <p>–°–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è —Å–≤–µ–∂–∏–µ –∞–Ω–æ–Ω—Å—ã —Ñ–∏–ª—å–º–æ–≤ –∏ –Ω–æ–≤–æ—Å—Ç–∏ –∫–∏–Ω–æ!</p>
            {% if user.is_superuser %}
            <a href="/admin/news/news/add/" class="add-first-news">
                –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é –Ω–æ–≤–æ—Å—Ç—å
            </a>
            {% endif %}
        </div>
        {% endfor %}
    </div>

    <!-- –ü–ê–ì–ò–ù–ê–¶–ò–Ø -->
    {% if news.has_other_pages %}
    <div class="pagination">
        {% if news.has_previous %}
        <a href="?page={{ news.previous_page_number }}{% if query %}&query={{ query }}{% endif %}" class="page-prev">
            ‚Üê –ù–∞–∑–∞–¥
        </a>
        {% endif %}

        <div class="page-numbers">
            {% for num in news.paginator.page_range %}
                {% if news.number == num %}
                <span class="page-current">{{ num }}</span>
                {% elif num > news.number|add:'-3' and num < news.number|add:'3' %}
                <a href="?page={{ num }}{% if query %}&query={{ query }}{% endif %}" class="page-number">
                    {{ num }}
                </a>
                {% endif %}
            {% endfor %}
        </div>

        {% if news.has_next %}
        <a href="?page={{ news.next_page_number }}{% if query %}&query={{ query }}{% endif %}" class="page-next">
            –í–ø–µ—Ä–µ–¥ ‚Üí
        </a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}