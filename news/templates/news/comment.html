<div class="comment">
    <div class="comment-header">
        <span class="comment-author">{{ comment.user.username }}</span>
        <span class="comment-date">{{ comment.published_at|date:"d.m H:i" }}</span>
    </div>

    <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
    <div class="comment-content">
        {{ comment.content|linebreaks }}
    </div>

    <div class="comment-reactions">
        <form method="post" action="{% url 'news:comment_reaction_create' comment.id %}">
            {% csrf_token %}
            <input type="hidden" name="reaction_type" value="1">
            <button type="submit" class="reaction-btn">
                üëç {{ comment.likes_count|default:"0" }}
            </button>
        </form>

        <form method="post" action="{% url 'news:comment_reaction_create' comment.id %}">
            {% csrf_token %}
            <input type="hidden" name="reaction_type" value="-1">
            <button type="submit" class="reaction-btn">
                üëé {{ comment.dislikes_count|default:"0" }}
            </button>
        </form>
    </div>

    {% if request.user == comment.user or request.user.is_superuser %}
        <div class="comment-delete">
            <form method="post" action="{% url 'news:comment_delete' comment.id %}"
                  onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π?')">
                {% csrf_token %}
                <button type="submit" class="delete-btn">
                    –£–¥–∞–ª–∏—Ç—å
                </button>
            </form>
        </div>
    {% endif %}

    <details class="reply-section">
        <summary class="reply-btn">–û—Ç–≤–µ—Ç–∏—Ç—å</summary>

        {% if user.is_authenticated %}
            <div class="add-comment">
                <form method="post" action="{% url 'news:comment_create' news.id %}">
                </form>
            </div>
        {% else %}
            <div class="login-to-comment">
                <p><a href="{% url 'login' %}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</p>
            </div>
        {% endif %}

        <div class="reply-form-container">
            <form method="post" action="{% url 'news:comment_create' news.id %}">
                {% csrf_token %}
                <textarea name="content" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç" required></textarea>
                <input type="hidden" name="parent" value="{{ comment.id }}">
                <button type="submit" class="reaction-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </details>

    {% for child_comment in all_comments %}
        {% if child_comment.parent_id == comment.id %}
            <div class="replies">
                {% include 'news/comment.html' with comment=child_comment all_comments=all_comments news=news %}
            </div>
        {% endif %}
    {% endfor %}
</div>