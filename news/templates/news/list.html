{% extends 'films/base.html' %}
{% load static %}

{% block title %}–ö–∏–Ω–æ–Ω–æ–≤–æ—Å—Ç–∏{% endblock %}

{% block content %}
<div class="news-container">
    <!-- –ó–ê–ì–û–õ–û–í–û–ö -->
    <div class="news-header">
        <h1>
            –ö–∏–Ω–æ–Ω–æ–≤–æ—Å—Ç–∏
            {% if user.is_superuser %}
              <a href="{% url 'news:news_create' %}" title="–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å" class="btn btn-primary"><i class="bi-plus-lg"></i></a>
            {% endif %}
        </h1>
    </div>

    <div class="search-section">
        <form>
          <div class="input-group mb-3">
            <input type="search" name="query" class="form-control" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞" value="{{query}}"/>
            <button type="submit" class="btn btn-primary">
                <i class="bi-search"></i>
            </button>
          </div>
        </form>
    </div>

    <!-- –°–ü–ò–°–û–ö –ù–û–í–û–°–¢–ï–ô -->
    <div class="news-grid">
        {% for item in news %}
        <div class="news-card">
            <!-- –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï -->
            {% if item.image %}
                <img src="{{ item.image.url }}" alt="{{ item.title }}" class="img-thumbnail news-image">
            {% endif %}

            {% if user.is_superuser %}
            <div class="d-grid gap-2 my-4">
              <a href="{% url 'news:news_update' item.id %}" class="btn btn-primary btn-block">
                <i class="bi-pencil-square"></i>
                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
              </a>
              <a href="{% url 'news:news_delete' item.id %}" class="btn btn-danger btn-block">
                <i class="bi-trash"></i>
                –£–¥–∞–ª–∏—Ç—å
              </a>
            </div>
            {% endif %}

            <!-- –ö–û–ù–¢–ï–ù–¢ -->
                <h2>
                    <a href="{% url 'news:news_detail' item.id %}">
                        {{ item.title }}
                    </a>
                </h2>

            <!-- –ú–ï–¢–ê –ò–ù–§–û–†–ú–ê–¶–ò–Ø -->
{#            <div class="news-meta">#}
{#                <span class="meta-likes">#}
{#                  ‚ù§Ô∏è {{ news.likes_count }}#}
{#                </span>#}
{#                <span class="meta-date">#}
{#                    {{ item.published_at|date:"d.m.Y" }}#}
{#                </span>#}
{#            </div>#}
        </div>
        {% empty %}
        <!-- –ï–°–õ–ò –ù–û–í–û–°–¢–ï–ô –ù–ï–¢ -->
        <div class="no-news">
            <div class="no-news-icon">
                üé•
            </div>
            <h3>–ù–æ–≤–æ—Å—Ç–µ–π –ø–æ–∫–∞ –Ω–µ—Ç</h3>
            <p>–°–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è —Å–≤–µ–∂–∏–µ –∞–Ω–æ–Ω—Å—ã —Ñ–∏–ª—å–º–æ–≤ –∏ –Ω–æ–≤–æ—Å—Ç–∏ –∫–∏–Ω–æ!</p>
            {% if user.is_superuser %}
            <a href="/admin/news/news/add/" class="add-first-news">
                –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é –Ω–æ–≤–æ—Å—Ç—å
            </a>
            {% endif %}
        </div>
        {% endfor %}
    </div>

    <!-- –ü–ê–ì–ò–ù–ê–¶–ò–Ø -->
    {% if news.has_other_pages %}
    <div class="pagination">
        {% if news.has_previous %}
        <a href="?page={{ news.previous_page_number }}{% if query %}&query={{ query }}{% endif %}" class="page-prev">
            ‚Üê –ù–∞–∑–∞–¥
        </a>
        {% endif %}

        <div class="page-numbers">
            {% for num in news.paginator.page_range %}
                {% if news.number == num %}
                <span class="page-current">{{ num }}</span>
                {% elif num > news.number|add:'-3' and num < news.number|add:'3' %}
                <a href="?page={{ num }}{% if query %}&query={{ query }}{% endif %}" class="page-number">
                    {{ num }}
                </a>
                {% endif %}
            {% endfor %}
        </div>

        {% if news.has_next %}
        <a href="?page={{ news.next_page_number }}{% if query %}&query={{ query }}{% endif %}" class="page-next">
            –í–ø–µ—Ä–µ–¥ ‚Üí
        </a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}